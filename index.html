<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta name="theme-color" content="#0d0a1a">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>×©×—×§×™ ××•×¨ â€” ×ª×—×–×™×ª ×©×§×™×¢×•×ª ×•×–×¨×™×—×•×ª</title>
<link rel="manifest" href="manifest.json">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Heebo:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0a0814;
  --surface: rgba(255,255,255,0.04);
  --border: rgba(255,255,255,0.08);
  --text: #f0e8d8;
  --muted: rgba(240,232,216,0.5);
  --gold: #e8b86d;
  --rose: #d4607a;
  --sky: #6ab0d4;
  --green: #5cb85c;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Heebo',sans-serif; background:var(--bg); color:var(--text); min-height:100dvh; overflow-x:hidden; }
body::before {
  content:''; position:fixed; inset:0; pointer-events:none; z-index:0;
  background:
    radial-gradient(ellipse 120% 60% at 50% 0%, rgba(212,96,122,0.15) 0%, transparent 60%),
    radial-gradient(ellipse 80% 40% at 80% 100%, rgba(232,184,109,0.1) 0%, transparent 50%),
    radial-gradient(ellipse 60% 30% at 20% 80%, rgba(106,176,212,0.08) 0%, transparent 50%);
}
body::after {
  content:''; position:fixed; inset:0; pointer-events:none; z-index:0;
  background-image:
    radial-gradient(1px 1px at 15% 10%, rgba(255,255,255,0.6) 0%, transparent 100%),
    radial-gradient(1px 1px at 35% 5%, rgba(255,255,255,0.4) 0%, transparent 100%),
    radial-gradient(1px 1px at 55% 15%, rgba(255,255,255,0.5) 0%, transparent 100%),
    radial-gradient(1px 1px at 72% 8%, rgba(255,255,255,0.3) 0%, transparent 100%),
    radial-gradient(1.5px 1.5px at 45% 3%, rgba(255,255,255,0.8) 0%, transparent 100%);
}

/* â”€â”€ Layout â”€â”€ */
.container { position:relative; z-index:1; max-width:480px; margin:0 auto; padding:24px 16px 40px; }

/* â”€â”€ Header â”€â”€ */
header { text-align:center; padding:28px 0 20px; }
.logo-icon { font-size:48px; display:block; margin-bottom:8px; filter:drop-shadow(0 0 20px rgba(232,184,109,0.5)); animation:float 4s ease-in-out infinite; }
@keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)} }
h1 { font-family:'Playfair Display',serif; font-size:28px; font-weight:700; margin-bottom:4px; }
.tagline { font-size:13px; color:var(--muted); letter-spacing:0.08em; text-transform:uppercase; }

/* â”€â”€ Tabs â”€â”€ */
.tabs { display:flex; gap:6px; margin:18px 0 14px; background:var(--surface); border:1px solid var(--border); border-radius:14px; padding:4px; }
.tab { flex:1; text-align:center; padding:8px 4px; border-radius:10px; font-size:13px; font-weight:600; cursor:pointer; transition:all 0.2s; color:var(--muted); border:none; background:none; font-family:'Heebo',sans-serif; }
.tab.active { background:rgba(232,184,109,0.18); color:var(--gold); }

/* â”€â”€ Location â”€â”€ */
.location-bar { display:flex; align-items:center; gap:8px; background:var(--surface); border:1px solid var(--border); border-radius:12px; padding:12px 16px; margin-bottom:10px; cursor:pointer; transition:background 0.2s; }
.location-bar:hover { background:rgba(255,255,255,0.07); }
.location-icon { font-size:18px; }
.location-text { flex:1; font-size:14px; color:var(--muted); }
.location-text strong { display:block; color:var(--text); font-size:15px; font-weight:600; }
.refresh-btn { background:rgba(232,184,109,0.15); border:1px solid rgba(232,184,109,0.3); border-radius:8px; color:var(--gold); font-size:12px; padding:6px 12px; cursor:pointer; font-family:'Heebo',sans-serif; transition:all 0.2s; }
.refresh-btn:hover { background:rgba(232,184,109,0.25); }
.refresh-btn:disabled { opacity:0.5; cursor:not-allowed; }

/* â”€â”€ City search â”€â”€ */
.city-search-row { display:flex; gap:8px; margin-bottom:18px; }
.city-input { flex:1; background:var(--surface); border:1px solid var(--border); border-radius:12px; color:var(--text); font-family:'Heebo',sans-serif; font-size:14px; padding:12px 16px; outline:none; transition:border-color 0.2s; direction:rtl; }
.city-input::placeholder { color:var(--muted); }
.city-input:focus { border-color:rgba(232,184,109,0.5); }
.city-search-btn { background:var(--surface); border:1px solid var(--border); border-radius:12px; color:var(--text); font-size:18px; padding:0 16px; cursor:pointer; transition:background 0.2s; }
.city-search-btn:hover { background:rgba(255,255,255,0.08); }

/* â”€â”€ Day cards â”€â”€ */
.day-card { background:var(--surface); border:1px solid var(--border); border-radius:20px; padding:20px; margin-bottom:14px; backdrop-filter:blur(10px); animation:slideUp 0.4s ease both; }
@keyframes slideUp { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
.day-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:14px; }
.day-name { font-family:'Playfair Display',serif; font-size:20px; font-weight:700; }
.day-date { font-size:12px; color:var(--muted); }
.weather-summary { display:flex; align-items:center; gap:6px; font-size:13px; color:var(--muted); }

/* â”€â”€ Sun events â”€â”€ */
.sun-events { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:14px; }
.sun-event { background:rgba(255,255,255,0.03); border:1px solid var(--border); border-radius:14px; padding:14px; }
.sun-event-title { font-size:11px; color:var(--muted); text-transform:uppercase; letter-spacing:0.1em; margin-bottom:4px; }
.sun-event-time { font-size:18px; font-weight:600; margin-bottom:10px; }
.score-label { font-size:11px; color:var(--muted); margin-bottom:6px; display:flex; justify-content:space-between; }
.score-value { font-weight:600; font-size:13px; }
.score-bar-track { height:6px; border-radius:3px; background:rgba(255,255,255,0.07); overflow:hidden; margin-bottom:8px; }
.score-bar-fill { height:100%; border-radius:3px; transition:width 1s ease; }
.score-description { font-size:12px; font-weight:600; }
.quality-spectacular{color:#ff7b54} .quality-vivid{color:#ffb347} .quality-nice{color:#ffd700} .quality-mild{color:#87ceeb} .quality-poor{color:var(--muted)}
.bar-spectacular{background:linear-gradient(90deg,#ff7b54,#ff4e50)} .bar-vivid{background:linear-gradient(90deg,#ff9a44,#fc6076)} .bar-nice{background:linear-gradient(90deg,#ffd700,#f9a825)} .bar-mild{background:linear-gradient(90deg,#87ceeb,#5b9bd5)} .bar-poor{background:linear-gradient(90deg,#6b7280,#4b5563)}
.color-palette { display:flex; gap:3px; margin-top:8px; border-radius:6px; overflow:hidden; height:8px; }
.palette-swatch { flex:1; border-radius:2px; }

/* â”€â”€ Detailed weather â”€â”€ */
.weather-detail { background:rgba(255,255,255,0.02); border:1px solid var(--border); border-radius:14px; padding:14px; margin-top:2px; }
.weather-detail-title { font-size:11px; color:var(--muted); text-transform:uppercase; letter-spacing:0.08em; margin-bottom:12px; }
.weather-grid { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
.weather-item { display:flex; align-items:center; gap:8px; }
.weather-item-icon { font-size:20px; }
.weather-item-text { font-size:12px; color:var(--muted); }
.weather-item-text strong { display:block; color:var(--text); font-size:14px; font-weight:600; }
.hourly-strip { display:flex; gap:6px; overflow-x:auto; padding-bottom:6px; margin-top:12px; scrollbar-width:none; }
.hourly-strip::-webkit-scrollbar { display:none; }
.hourly-item { flex-shrink:0; text-align:center; background:rgba(255,255,255,0.03); border:1px solid var(--border); border-radius:10px; padding:8px 10px; min-width:52px; }
.hourly-time { font-size:10px; color:var(--muted); margin-bottom:4px; }
.hourly-icon { font-size:18px; margin-bottom:4px; }
.hourly-temp { font-size:13px; font-weight:600; }
.hourly-cloud { font-size:10px; color:var(--muted); }

/* â”€â”€ Rating popup â”€â”€ */
.rating-row { display:flex; align-items:center; justify-content:space-between; margin-top:12px; padding-top:12px; border-top:1px solid var(--border); }
.rating-label { font-size:12px; color:var(--muted); }
.rating-stars { display:flex; gap:4px; }
.rating-star { font-size:22px; cursor:pointer; opacity:0.35; transition:all 0.15s; }
.rating-star.active { opacity:1; transform:scale(1.15); }
.rating-saved { font-size:11px; color:var(--green); margin-top:4px; display:none; }

/* â”€â”€ Journal tab â”€â”€ */
.journal-empty { text-align:center; padding:48px 20px; color:var(--muted); }
.journal-empty .je-icon { font-size:48px; display:block; margin-bottom:12px; }
.journal-entry { background:var(--surface); border:1px solid var(--border); border-radius:16px; padding:16px; margin-bottom:12px; animation:slideUp 0.3s ease both; }
.journal-entry-header { display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:8px; }
.journal-entry-date { font-family:'Playfair Display',serif; font-size:16px; }
.journal-entry-loc { font-size:12px; color:var(--muted); }
.journal-entry-type { font-size:11px; color:var(--muted); text-transform:uppercase; letter-spacing:0.08em; }
.journal-scores { display:flex; flex-wrap:wrap; gap:8px 16px; margin-top:8px; }
.journal-score-item { font-size:13px; }
.journal-score-item span { font-weight:600; }
.journal-delete { background:none; border:none; color:var(--muted); font-size:16px; cursor:pointer; padding:2px 6px; border-radius:6px; }
.journal-delete:hover { color:var(--rose); background:rgba(212,96,122,0.1); }

/* â”€â”€ World map tab â”€â”€ */
.world-map-header { text-align:center; margin-bottom:16px; }
.world-map-header p { font-size:13px; color:var(--muted); margin-top:4px; }
.hotspot-card { background:var(--surface); border:1px solid var(--border); border-radius:16px; padding:16px; margin-bottom:10px; display:flex; align-items:center; gap:14px; animation:slideUp 0.3s ease both; }
.hotspot-rank { font-family:'Playfair Display',serif; font-size:24px; font-weight:700; color:var(--gold); min-width:32px; text-align:center; }
.hotspot-info { flex:1; }
.hotspot-name { font-size:15px; font-weight:600; margin-bottom:2px; }
.hotspot-desc { font-size:12px; color:var(--muted); }
.hotspot-score { text-align:center; }
.hotspot-score-num { font-size:22px; font-weight:700; }
.hotspot-score-label { font-size:10px; color:var(--muted); text-transform:uppercase; }

/* â”€â”€ Notification banner â”€â”€ */
.notif-banner { display:flex; align-items:center; gap:10px; background:rgba(92,184,92,0.08); border:1px solid rgba(92,184,92,0.25); border-radius:14px; padding:12px 16px; margin-bottom:14px; }
.notif-banner p { flex:1; font-size:13px; color:var(--muted); line-height:1.5; }
.notif-banner strong { color:var(--green); display:block; font-size:14px; margin-bottom:2px; }
.notif-toggle { background:rgba(92,184,92,0.15); border:1px solid rgba(92,184,92,0.3); border-radius:8px; color:var(--green); font-size:12px; padding:6px 12px; cursor:pointer; font-family:'Heebo',sans-serif; white-space:nowrap; }
.notif-toggle.off { background:rgba(255,255,255,0.05); border-color:var(--border); color:var(--muted); }

/* â”€â”€ Loading / Error â”€â”€ */
.loading { text-align:center; padding:60px 20px; color:var(--muted); }
.loading-spinner { font-size:40px; display:block; margin-bottom:16px; animation:spin 2s linear infinite; }
@keyframes spin { from{transform:rotate(0deg)} to{transform:rotate(360deg)} }
.error-box { background:rgba(212,96,122,0.1); border:1px solid rgba(212,96,122,0.3); border-radius:16px; padding:24px; text-align:center; margin:20px 0; }
.error-box h3 { color:var(--rose); margin-bottom:8px; font-size:16px; }
.error-box p { font-size:13px; color:var(--muted); line-height:1.6; }
.btn-primary { display:block; width:100%; margin-top:16px; background:linear-gradient(135deg,var(--rose),var(--gold)); border:none; border-radius:12px; color:white; font-family:'Heebo',sans-serif; font-size:15px; font-weight:600; padding:14px; cursor:pointer; }

/* â”€â”€ Share / Footer â”€â”€ */
.share-section { margin-top:20px; text-align:center; }
.share-btn { display:inline-flex; align-items:center; gap:8px; background:rgba(255,255,255,0.06); border:1px solid var(--border); border-radius:12px; color:var(--text); font-family:'Heebo',sans-serif; font-size:14px; padding:12px 24px; cursor:pointer; transition:all 0.2s; }
.share-btn:hover { background:rgba(255,255,255,0.1); }
footer { text-align:center; margin-top:32px; font-size:11px; color:rgba(240,232,216,0.25); line-height:1.8; }

/* â”€â”€ Install banner â”€â”€ */
.install-banner { display:none; align-items:center; gap:12px; background:rgba(232,184,109,0.08); border:1px solid rgba(232,184,109,0.2); border-radius:14px; padding:14px 16px; margin-bottom:16px; }
.install-banner.visible { display:flex; }
.install-banner p { flex:1; font-size:13px; color:var(--muted); line-height:1.5; }
.install-banner strong { color:var(--gold); display:block; font-size:14px; margin-bottom:2px; }
.install-dismiss { background:none; border:none; color:var(--muted); font-size:20px; cursor:pointer; padding:4px; }
</style>
</head>
<body>
<div class="container">
  <header>
    <span class="logo-icon">ğŸŒ…</span>
    <h1>×©×—×§×™ ××•×¨</h1>
    <p class="tagline">×ª×—×–×™×ª ×¦×‘×¢×•× ×™×•×ª ×©×§×™×¢×•×ª ×•×–×¨×™×—×•×ª</p>
  </header>

  <div class="install-banner" id="installBanner">
    <div>
      <strong>ğŸ“² ×”×ª×§×Ÿ ×›××¤×œ×™×§×¦×™×”</strong>
      <p>×©×ª×£ â† "×”×•×¡×£ ×œ××¡×š ×”×‘×™×ª"</p>
    </div>
    <button class="install-dismiss" onclick="document.getElementById('installBanner').classList.remove('visible')">Ã—</button>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab active" onclick="switchTab('forecast')">ğŸŒ… ×ª×—×–×™×ª</button>
    <button class="tab" onclick="switchTab('journal')">ğŸ““ ×™×•××Ÿ</button>
    <button class="tab" onclick="switchTab('world')">ğŸ—ºï¸ ×¢×•×œ×</button>
  </div>

  <!-- Location -->
  <div class="location-bar" onclick="loadData()">
    <span class="location-icon">ğŸ“</span>
    <div class="location-text">
      <strong id="locationName">×œ×—×¥ ×œ××™×ª×•×¨ ××™×§×•×</strong>
      <span id="locationCoords">GPS ××•×˜×•××˜×™</span>
    </div>
    <button class="refresh-btn" id="refreshBtn" onclick="event.stopPropagation();loadData()">GPS</button>
  </div>
  <div class="city-search-row">
    <input class="city-input" id="cityInput" type="text" placeholder="××• ×—×¤×© ×¢×™×¨... (×œ×“×•×’××”: ×ª×œ ××‘×™×‘)" onkeydown="if(event.key==='Enter')searchCity()"/>
    <button class="city-search-btn" onclick="searchCity()">ğŸ”</button>
  </div>

  <!-- Notification banner -->
  <div class="notif-banner" id="notifBanner">
    <div>
      <strong>ğŸ”” ×”×ª×¨××•×ª ×©×§×™×¢×”</strong>
      <p>×§×‘×œ ×”×ª×¨××” ×©×¢×” ×œ×¤× ×™ ×©×§×™×¢×”/×–×¨×™×—×” ××“×”×™××” (×¦×™×•×Ÿ 8+)</p>
    </div>
    <button class="notif-toggle off" id="notifBtn" onclick="toggleNotifications()">×”×¤×¢×œ</button>
  </div>

  <!-- Tab content -->
  <div id="tab-forecast">
    <div id="content">
      <div class="loading">
        <span>ğŸŒ</span>
        <p style="margin-top:12px">×œ×—×¥ GPS ××• ×—×¤×© ×¢×™×¨</p>
      </div>
    </div>
    <div class="share-section" id="shareSection" style="display:none">
      <button class="share-btn" onclick="shareApp()"><span>ğŸ“¤</span> ×©×ª×£ ×¢× ×—×‘×¨×™×</button>
    </div>
  </div>

  <div id="tab-journal" style="display:none">
    <div id="journalContent"></div>
  </div>

  <div id="tab-world" style="display:none">
    <div id="worldContent"></div>
  </div>

  <footer>
    × ×ª×•× ×™ ××–×’ ××•×•×™×¨: Open-Meteo â€¢ ×©××©: sunrise-sunset.org<br>
    ×©×—×§×™ ××•×¨ Â© 2025
  </footer>
</div>

<script>
const DAYS_HE = ['×¨××©×•×Ÿ','×©× ×™','×©×œ×™×©×™','×¨×‘×™×¢×™','×—××™×©×™','×©×™×©×™','×©×‘×ª'];
const MONTHS_HE = ['×™× ×•××¨','×¤×‘×¨×•××¨','××¨×¥','××¤×¨×™×œ','×××™','×™×•× ×™','×™×•×œ×™','××•×’×•×¡×˜','×¡×¤×˜××‘×¨','××•×§×˜×•×‘×¨','× ×•×‘××‘×¨','×“×¦××‘×¨'];
let userLat, userLon, currentWeatherData, currentSunData, currentCityName;
let notifEnabled = false;
let notifTimers = [];
let worldLoaded = false;

// â”€â”€ Storage helpers â”€â”€
function saveJournal(entries) { try { localStorage.setItem('shakey_journal', JSON.stringify(entries)); } catch{} }
function loadJournal() { try { return JSON.parse(localStorage.getItem('shakey_journal') || '[]'); } catch{ return []; } }

// â”€â”€ Tab switching â”€â”€
function switchTab(tab) {
  ['forecast','journal','world'].forEach(t => {
    document.getElementById('tab-'+t).style.display = t===tab ? 'block' : 'none';
  });
  document.querySelectorAll('.tab').forEach((el,i) => {
    el.classList.toggle('active', ['forecast','journal','world'][i]===tab);
  });
  if (tab==='journal') renderJournal();
  if (tab==='world' && !worldLoaded) { worldLoaded=true; renderWorld(); }
}

// â”€â”€ Init â”€â”€
function init() {
  if (/Mobi|Android/i.test(navigator.userAgent) && !window.matchMedia('(display-mode: standalone)').matches) {
    document.getElementById('installBanner').classList.add('visible');
  }
  // Check saved notification pref
  if (localStorage.getItem('shakey_notif') === '1') {
    notifEnabled = true;
    document.getElementById('notifBtn').textContent = '×¤×¢×™×œ âœ“';
    document.getElementById('notifBtn').classList.remove('off');
  }
  loadData();
}

// â”€â”€ GPS â”€â”€
async function loadData() {
  const btn = document.getElementById('refreshBtn');
  btn.disabled = true; btn.textContent = '...';
  document.getElementById('content').innerHTML = `<div class="loading"><span class="loading-spinner">ğŸ›°ï¸</span><p>×××ª×¨ ××™×§×•×...</p></div>`;
  try {
    const pos = await getLocation();
    userLat = pos.coords.latitude;
    userLon = pos.coords.longitude;
    await fetchAndRender();
  } catch(e) {
    document.getElementById('locationName').textContent = 'GPS ×œ× ×–××™×Ÿ';
    document.getElementById('locationCoords').textContent = '×—×¤×© ×¢×™×¨ ×™×“× ×™×ª ×œ××˜×”';
    document.getElementById('content').innerHTML = `
      <div class="error-box" style="border-color:rgba(232,184,109,0.3);background:rgba(232,184,109,0.07)">
        <h3 style="color:var(--gold)">ğŸ“ ×œ× × ×™×ª×Ÿ ×œ××ª×¨ ××™×§×•× ××•×˜×•××˜×™×ª</h3>
        <p>×›×¨×•× ×—×•×¡× GPS ××§×‘×¦×™× ××§×•××™×™×.<br>×”×§×œ×“ ×¢×™×¨ ×‘×ª×™×‘×ª ×”×—×™×¤×•×© ×œ××¢×œ×”.</p>
      </div>`;
    setTimeout(() => { const inp=document.getElementById('cityInput'); if(inp){inp.focus();inp.scrollIntoView({behavior:'smooth',block:'center'});} }, 300);
  }
  btn.disabled = false; btn.textContent = 'GPS';
}

function getLocation() {
  return new Promise((res,rej) => {
    if (!navigator.geolocation) rej(new Error('GPS ××™× ×• × ×ª××š'));
    navigator.geolocation.getCurrentPosition(res, (e) => {
      if (e.code===1) rej(new Error('× × ×œ××¤×©×¨ ×’×™×©×” ×œ××™×§×•×'));
      else rej(new Error('×œ× × ×™×ª×Ÿ ×œ××ª×¨ ××™×§×•×'));
    }, {timeout:10000});
  });
}

// â”€â”€ City search â”€â”€
async function searchCity() {
  const query = document.getElementById('cityInput').value.trim();
  if (!query) return;
  document.getElementById('content').innerHTML = `<div class="loading"><span class="loading-spinner">ğŸ”</span><p>××—×¤×© "${query}"...</p></div>`;
  document.getElementById('shareSection').style.display='none';
  try {
    const res = await fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(query)}&format=json&limit=1&accept-language=he`);
    const data = await res.json();
    if (!data.length) throw new Error(`×œ× × ××¦××” ×¢×™×¨ ×‘×©× "${query}"`);
    userLat = parseFloat(data[0].lat);
    userLon = parseFloat(data[0].lon);
    currentCityName = data[0].display_name.split(',')[0];
    document.getElementById('locationName').textContent = currentCityName;
    document.getElementById('locationCoords').textContent = `${userLat.toFixed(4)}Â°, ${userLon.toFixed(4)}Â°`;
    document.getElementById('content').innerHTML = `<div class="loading"><span class="loading-spinner">ğŸŒ¤ï¸</span><p>××•×¨×™×“ ×ª×—×–×™×ª...</p></div>`;
    await fetchAndRender();
  } catch(e) {
    document.getElementById('content').innerHTML = `<div class="error-box"><h3>×©×’×™××”</h3><p>${e.message}</p></div>`;
  }
}

// â”€â”€ Fetch + render â”€â”€
async function fetchAndRender() {
  const [weatherData, sunData] = await Promise.all([
    fetchWeather(userLat, userLon),
    fetchSunTimes(userLat, userLon)
  ]);
  currentWeatherData = weatherData;
  currentSunData = sunData;
  worldLoaded = false; // reset so world tab refreshes
  renderCards(weatherData, sunData);
  document.getElementById('shareSection').style.display='block';
  if (notifEnabled) scheduleNotifications(sunData, weatherData);
}

// â”€â”€ Weather API â”€â”€
async function fetchWeather(lat, lon) {
  const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=cloudcover,relativehumidity_2m,precipitation,windspeed_10m,weathercode,temperature_2m&daily=weathercode,precipitation_sum,temperature_2m_max,temperature_2m_min,windspeed_10m_max,uv_index_max&timezone=auto&forecast_days=3`;
  try {
    const res = await fetch(url);
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    return await res.json();
  } catch(e) {
    console.warn('Weather API failed:', e.message);
    return null;
  }
}

async function fetchSunTimes(lat, lon) {
  const results = [];
  const today = new Date();
  for (let i=0; i<3; i++) {
    const d = new Date(today); d.setDate(today.getDate()+i);
    const dateStr = d.toISOString().split('T')[0];
    try {
      const res = await fetch(`https://api.sunrise-sunset.org/json?lat=${lat}&lng=${lon}&date=${dateStr}&formatted=0`);
      const data = await res.json();
      results.push(data.results);
    } catch { results.push(null); }
  }
  return results;
}

function getHourlyIndex(data, targetDateStr, targetHour) {
  const times = data.hourly.time;
  const target = `${targetDateStr}T${String(targetHour).padStart(2,'0')}:00`;
  let idx = times.findIndex(t => t===target);
  if (idx===-1) {
    // Find closest hour on that date
    const dateStart = times.findIndex(t => t.startsWith(targetDateStr));
    if (dateStart === -1) return 0;
    // Find the entry with closest hour
    let best = dateStart;
    let bestDiff = 24;
    for (let j=dateStart; j<Math.min(dateStart+24, times.length); j++) {
      const h = parseInt(times[j].split('T')[1]?.substring(0,2) ?? '0');
      const diff = Math.abs(h - targetHour);
      if (diff < bestDiff) { bestDiff=diff; best=j; }
    }
    idx = best;
  }
  return idx>=0 ? idx : 0;
}

// â”€â”€ Score calculation â”€â”€
function calcColorScore(cloudCover, humidity, rain, windspeed) {
  let score = 5;
  if (cloudCover < 10) score -= 1;
  else if (cloudCover <= 40) score += 3;
  else if (cloudCover <= 60) score += 1.5;
  else if (cloudCover <= 80) score -= 1;
  else score -= 3;
  if (rain > 5) score -= 2;
  else if (rain > 1) score -= 1;
  else if (rain===0 && cloudCover>20 && cloudCover<60) score += 0.5;
  if (humidity>40 && humidity<70) score += 0.5;
  else if (humidity>80) score -= 0.5;
  if (windspeed>30) score += 0.5;
  return Math.min(10, Math.max(1, Math.round(score*10)/10));
}

function getQualityInfo(score) {
  if (score>=8.5) return {label:'ğŸ”¥ ××”××!', cls:'spectacular', barCls:'bar-spectacular'};
  if (score>=7)   return {label:'ğŸŒŸ ×ª×•×¡×¡ ×•×¢×©×™×¨', cls:'vivid', barCls:'bar-vivid'};
  if (score>=5.5) return {label:'âœ¨ ×™×¤×”', cls:'nice', barCls:'bar-nice'};
  if (score>=4)   return {label:'ğŸŒ¤ï¸ ×¢×“×™×Ÿ', cls:'mild', barCls:'bar-mild'};
  return {label:'â˜ï¸ ×—×œ×©', cls:'poor', barCls:'bar-poor'};
}

function getPalette(score, isSunset) {
  if (score>=8.5) return isSunset ? ['#ff2d00','#ff6b2b','#ff9a44','#ffc96e','#ffe8a8'] : ['#ff4e6a','#ff8c69','#ffb347','#ffd700','#87ceeb'];
  if (score>=7)   return isSunset ? ['#e8390e','#f5712d','#f9a825','#fdd835','#fff3b0'] : ['#c0392b','#e67e22','#f39c12','#f1c40f','#aed6f1'];
  if (score>=5.5) return isSunset ? ['#c0392b','#e07030','#e8a040','#f5d080','#ffe0a0'] : ['#8e44ad','#d35400','#e67e22','#f39c12','#d4e6f1'];
  if (score>=4)   return ['#5b7a9d','#7ea8c4','#a8c4d8','#c8dce8','#e0eaf2'];
  return ['#4a5568','#6b7280','#9ca3af','#d1d5db','#e5e7eb'];
}

function formatLocalTime(utcStr) {
  if (!utcStr) return '--:--';
  try { return new Date(utcStr).toLocaleTimeString('he-IL',{hour:'2-digit',minute:'2-digit'}); }
  catch { return '--:--'; }
}

function weatherCodeToEmoji(code) {
  if (code===0) return 'â˜€ï¸'; if (code<=2) return 'â›…'; if (code<=3) return 'â˜ï¸';
  if (code<=49) return 'ğŸŒ«ï¸'; if (code<=67) return 'ğŸŒ§ï¸'; if (code<=77) return 'â„ï¸';
  if (code<=82) return 'ğŸŒ¦ï¸'; return 'â›ˆï¸';
}
function weatherCodeToText(code) {
  if (code===0) return '×©××™×™× ×‘×”×™×¨×™×'; if (code<=2) return '××¢×•× ×Ÿ ×—×œ×§×™×ª'; if (code<=3) return '××¢×•× ×Ÿ';
  if (code<=49) return '×¢×¨×¤×œ'; if (code<=67) return '×’×©×'; if (code<=77) return '×©×œ×’';
  if (code<=82) return '×××˜×¨×™×'; return '×¡×•×¤×ª ×‘×¨×§×™×';
}

// â”€â”€ Render forecast cards â”€â”€
function renderCards(weatherData, sunData) {
  const today = new Date();
  let html = '<div id="dayCards">';

  for (let i=0; i<3; i++) {
    const d = new Date(today); d.setDate(today.getDate()+i);
    const dayName = i===0 ? '×”×™×•×' : i===1 ? '××—×¨' : `×™×•× ${DAYS_HE[d.getDay()]}`;
    const dateStrDisplay = `${d.getDate()} ×‘${MONTHS_HE[d.getMonth()]}`;
    const dateStr = d.toISOString().split('T')[0];
    const wCode = weatherData?.daily?.weathercode?.[i] ?? 1;

    const sunriseUTC = sunData[i]?.sunrise;
    const sunsetUTC  = sunData[i]?.sunset;
    const srHour = sunriseUTC ? new Date(sunriseUTC).getHours() : 6;
    const ssHour = sunsetUTC  ? new Date(sunsetUTC).getHours()  : 19;

    let srCloud,srHumidity,srRain,srWind,ssCloud,ssHumidity,ssRain,ssWind;
    let tempMax='--', tempMin='--', uvIndex='--', wind='--', rain='--';

    if (weatherData?.hourly) {
      const srIdx = getHourlyIndex(weatherData, dateStr, srHour);
      const ssIdx = getHourlyIndex(weatherData, dateStr, ssHour);
      srCloud=weatherData.hourly.cloudcover[srIdx]??40;
      srHumidity=weatherData.hourly.relativehumidity_2m[srIdx]??55;
      srRain=weatherData.hourly.precipitation[srIdx]??0;
      srWind=weatherData.hourly.windspeed_10m[srIdx]??15;
      ssCloud=weatherData.hourly.cloudcover[ssIdx]??40;
      ssHumidity=weatherData.hourly.relativehumidity_2m[ssIdx]??55;
      ssRain=weatherData.hourly.precipitation[ssIdx]??0;
      ssWind=weatherData.hourly.windspeed_10m[ssIdx]??15;
    } else {
      srCloud=ssCloud=40; srHumidity=ssHumidity=55; srRain=ssRain=0; srWind=ssWind=15;
    }

    if (weatherData?.daily) {
      tempMax = weatherData.daily.temperature_2m_max?.[i]?.toFixed(0) ?? '--';
      tempMin = weatherData.daily.temperature_2m_min?.[i]?.toFixed(0) ?? '--';
      uvIndex = weatherData.daily.uv_index_max?.[i]?.toFixed(0) ?? '--';
      wind    = weatherData.daily.windspeed_10m_max?.[i]?.toFixed(0) ?? '--';
      rain    = weatherData.daily.precipitation_sum?.[i]?.toFixed(1) ?? '--';
    }

    const sunriseScore  = calcColorScore(srCloud, srHumidity, srRain, srWind);
    const ssScoreClamped = calcColorScore(ssCloud, ssHumidity, ssRain, ssWind);
    const srQ = getQualityInfo(sunriseScore);
    const ssQ = getQualityInfo(ssScoreClamped);
    const sunrise = sunData[i] ? formatLocalTime(sunData[i].sunrise) : '--:--';
    const sunset  = sunData[i] ? formatLocalTime(sunData[i].sunset)  : '--:--';
    const srPaletteHtml = getPalette(sunriseScore,false).map(c=>`<div class="palette-swatch" style="background:${c}"></div>`).join('');
    const ssPaletteHtml = getPalette(ssScoreClamped,true).map(c=>`<div class="palette-swatch" style="background:${c}"></div>`).join('');

    // Hourly strip (every 3h)
    let hourlyHtml = '';
    if (weatherData?.hourly) {
      const baseIdx = getHourlyIndex(weatherData, dateStr, 0);
      for (let h=0; h<8; h++) {
        const idx = baseIdx + h*3;
        if (idx >= weatherData.hourly.time.length) break;
        const time = weatherData.hourly.time[idx].split('T')[1]?.substring(0,5) ?? '';
        const temp = weatherData.hourly.temperature_2m?.[idx]?.toFixed(0) ?? '--';
        const cloud = weatherData.hourly.cloudcover?.[idx] ?? 0;
        const wc = weatherData.hourly.weathercode?.[idx] ?? 0;
        hourlyHtml += `<div class="hourly-item"><div class="hourly-time">${time}</div><div class="hourly-icon">${weatherCodeToEmoji(wc)}</div><div class="hourly-temp">${temp}Â°</div><div class="hourly-cloud">â˜ï¸${cloud}%</div></div>`;
      }
    }

    const entryId = `${dateStr}-${i}`;
    const journal = loadJournal();
    const existing = journal.find(e => e.id===entryId);
    const savedRatingHtml = existing ? `<div class="rating-saved" style="display:block">âœ“ ×“×™×¨×’×ª ${existing.actualRating}â˜…</div>` : '';

    html += `
    <div class="day-card" style="animation-delay:${i*0.12}s">
      <div class="day-header">
        <div><div class="day-name">${dayName}</div><div class="day-date">${dateStrDisplay}</div></div>
        <div class="weather-summary">
          <span>${weatherCodeToEmoji(wCode)}</span>
          <span>${weatherCodeToText(wCode)}</span>
        </div>
      </div>

      <div class="sun-events">
        <div class="sun-event">
          <div class="sun-event-title">ğŸŒ„ ×–×¨×™×—×”</div>
          <div class="sun-event-time">${sunrise}</div>
          <div class="score-label"><span>×¦×‘×¢×•× ×™×•×ª</span><span class="score-value quality-${srQ.cls}">${sunriseScore}/10</span></div>
          <div class="score-bar-track"><div class="score-bar-fill ${srQ.barCls}" style="width:${sunriseScore*10}%"></div></div>
          <div class="score-description quality-${srQ.cls}">${srQ.label}</div>
          <div class="color-palette">${srPaletteHtml}</div>
        </div>
        <div class="sun-event">
          <div class="sun-event-title">ğŸŒ‡ ×©×§×™×¢×”</div>
          <div class="sun-event-time">${sunset}</div>
          <div class="score-label"><span>×¦×‘×¢×•× ×™×•×ª</span><span class="score-value quality-${ssQ.cls}">${ssScoreClamped}/10</span></div>
          <div class="score-bar-track"><div class="score-bar-fill ${ssQ.barCls}" style="width:${ssScoreClamped*10}%"></div></div>
          <div class="score-description quality-${ssQ.cls}">${ssQ.label}</div>
          <div class="color-palette">${ssPaletteHtml}</div>
        </div>
      </div>

      <!-- Detailed weather -->
      <div class="weather-detail">
        <div class="weather-detail-title">×ª×—×–×™×ª ××¤×•×¨×˜×ª</div>
        <div class="weather-grid">
          <div class="weather-item"><span class="weather-item-icon">ğŸŒ¡ï¸</span><div class="weather-item-text"><strong>${tempMax}Â° / ${tempMin}Â°</strong>×˜××¤×¨×˜×•×¨×”</div></div>
          <div class="weather-item"><span class="weather-item-icon">ğŸ’§</span><div class="weather-item-text"><strong>${rain} ×"×</strong>××©×§×¢×™×</div></div>
          <div class="weather-item"><span class="weather-item-icon">ğŸ’¨</span><div class="weather-item-text"><strong>${wind} ×§×"×©</strong>×¨×•×— ××§×¡×™××œ×™×ª</div></div>
          <div class="weather-item"><span class="weather-item-icon">â˜€ï¸</span><div class="weather-item-text"><strong>UV ${uvIndex}</strong>×§×¨×™× ×”</div></div>
          <div class="weather-item"><span class="weather-item-icon">â˜ï¸</span><div class="weather-item-text"><strong>${srCloud}% / ${ssCloud}%</strong>×¢× ×Ÿ ×–×¨×™×—×”/×©×§×™×¢×”</div></div>
          <div class="weather-item"><span class="weather-item-icon">ğŸ’¦</span><div class="weather-item-text"><strong>${srHumidity}%</strong>×œ×—×•×ª</div></div>
        </div>
        ${hourlyHtml ? `<div class="hourly-strip">${hourlyHtml}</div>` : ''}
      </div>

      <!-- Rating row -->
      <div class="rating-row">
        <div>
          <div class="rating-label">×“×¨×’ ××ª ×”×©×§×™×¢×” ×”×××™×ª×™×ª ğŸ‘‡</div>
          <div class="rating-saved" id="saved-${entryId}" style="display:${existing ? 'block' : 'none'}">${existing ? `âœ“ ×“×™×¨×’×ª ${existing.actualRating}â˜…` : ''}</div>
        </div>
        <div class="rating-stars" id="stars-${entryId}">
          ${[1,2,3,4,5].map(s=>`<span class="rating-star ${existing&&existing.actualRating>=s?'active':''}" onclick="rateEvent('${entryId}','${dateStrDisplay}',${s},${sunriseScore},${ssScoreClamped})">â­</span>`).join('')}
        </div>
      </div>
    </div>`;
  }

  html += '</div>';
  document.getElementById('content').innerHTML = html;
}

// â”€â”€ Rating / Journal â”€â”€
function rateEvent(entryId, dateDisplay, stars, srScore, ssScore) {
  // Highlight stars
  const container = document.getElementById('stars-'+entryId);
  if (container) {
    container.querySelectorAll('.rating-star').forEach((el,i) => el.classList.toggle('active', i<stars));
  }
  // Save to journal
  const journal = loadJournal();
  const existing = journal.findIndex(e => e.id===entryId);
  const entry = {
    id: entryId,
    date: dateDisplay,
    location: document.getElementById('locationName').textContent,
    actualRating: stars,
    predictedSunrise: srScore,
    predictedSunset: ssScore,
    ts: Date.now()
  };
  if (existing>=0) journal[existing]=entry; else journal.unshift(entry);
  saveJournal(journal);
  const savedEl = document.getElementById('saved-'+entryId);
  if (savedEl) { savedEl.textContent=`âœ“ ×“×™×¨×’×ª ${stars}â˜…`; savedEl.style.display='block'; }
}

function renderJournal() {
  const journal = loadJournal();
  const el = document.getElementById('journalContent');
  if (!journal.length) {
    el.innerHTML = `<div class="journal-empty"><span class="je-icon">ğŸ““</span><p>×¢×“×™×™×Ÿ ××™×Ÿ ×¢×¨×›×™× ×‘×™×•××Ÿ.<br>×“×¨×’ ×©×§×™×¢×•×ª ××”×ª×—×–×™×ª!</p></div>`;
    return;
  }
  el.innerHTML = journal.map(e => `
    <div class="journal-entry">
      <div class="journal-entry-header">
        <div>
          <div class="journal-entry-date">${e.date}</div>
          <div class="journal-entry-loc">ğŸ“ ${e.location}</div>
        </div>
        <button class="journal-delete" onclick="deleteJournalEntry('${e.id}')">ğŸ—‘ï¸</button>
      </div>
      <div class="journal-scores">
        <div class="journal-score-item">×ª×—×–×™×ª ×–×¨×™×—×”: <span class="quality-${getQualityInfo(e.predictedSunrise).cls}">${e.predictedSunrise}/10</span></div>
        <div class="journal-score-item">×ª×—×–×™×ª ×©×§×™×¢×”: <span class="quality-${getQualityInfo(e.predictedSunset).cls}">${e.predictedSunset}/10</span></div>
        <div class="journal-score-item">×“×™×¨×•×’ ×××™×ª×™: <span style="color:var(--gold)">${'â­'.repeat(e.actualRating)}</span></div>
      </div>
    </div>`).join('');
}

function deleteJournalEntry(id) {
  const journal = loadJournal().filter(e => e.id!==id);
  saveJournal(journal);
  renderJournal();
}

// â”€â”€ World map â”€â”€
const HOTSPOTS = [
  {name:'×¡× ×˜×•×¨×™× ×™, ×™×•×•×Ÿ', desc:'×©×§×™×¢×•×ª ××’×“×™×•×ª ××¢×œ ×”×§×œ×“×¨×”', lat:36.39, lon:25.46, emoji:'ğŸ‡¬ğŸ‡·'},
  {name:'×××•×•×™, ×”×•×•××™', desc:'×”×¨ ×”××œ××§×œ×” ××¢×œ ×”×¢× × ×™×', lat:20.80, lon:-156.33, emoji:'ğŸŒº'},
  {name:'×× ×’×§×•×¨ ×•××˜, ×§××‘×•×“×™×”', desc:'×–×¨×™×—×•×ª ××”×××•×ª ××¢×œ ×”××§×“×©×™×', lat:13.41, lon:103.86, emoji:'ğŸ‡°ğŸ‡­'},
  {name:'×¤×˜×’×•× ×™×”, ××¨×’× ×˜×™× ×”', desc:'×©××™×™× ×“×¨××˜×™×™× ×•×¤×ª×•×—×™×', lat:-50.0, lon:-73.0, emoji:'ğŸ‡¦ğŸ‡·'},
  {name:'×©×¨× ×-×©×™×™×—, ××¦×¨×™×', desc:'×©×§×™×¢×•×ª ××“×‘×¨×™×•×ª ×¢×œ ×”×™× ×”××“×•×', lat:27.91, lon:34.33, emoji:'ğŸ‡ªğŸ‡¬'},
  {name:'×§×™×™×¤ ×˜××•×Ÿ, ×“. ××¤×¨×™×§×”', desc:'×”×¨ ×©×•×œ×—×Ÿ ×•×©×§×™×¢×•×ª ××•×§×™×× ×•×¡', lat:-33.92, lon:18.42, emoji:'ğŸ‡¿ğŸ‡¦'},
];

async function renderWorld() {
  const el = document.getElementById('worldContent');
  el.innerHTML = `
    <div class="world-map-header">
      <h2 style="font-family:'Playfair Display',serif;font-size:20px">ğŸ—ºï¸ ×™×¢×“×™ ×©×§×™×¢×•×ª ××•×‘×™×œ×™×</h2>
      <p>×ª×—×–×™×ª ×¦×‘×¢×•× ×™×•×ª ×‘×–××Ÿ ×××ª ×œ××§×•××•×ª ×”×˜×•×‘×™× ×‘×¢×•×œ×</p>
    </div>
    <div class="loading"><span class="loading-spinner">ğŸŒ</span><p>××—×©×‘ ×ª×—×–×™×•×ª ×¢×•×œ××™×•×ª...</p></div>`;

  const results = await Promise.all(HOTSPOTS.map(async (spot, idx) => {
    try {
      const [w, s] = await Promise.all([fetchWeather(spot.lat, spot.lon), fetchSunTimes(spot.lat, spot.lon)]);
      const sunsetUTC = s[0]?.sunset;
      const ssHour = sunsetUTC ? new Date(sunsetUTC).getHours() : 19;
      const today = new Date().toISOString().split('T')[0];
      let score = 5;
      if (w?.hourly) {
        const ssIdx = getHourlyIndex(w, today, ssHour);
        score = calcColorScore(w.hourly.cloudcover[ssIdx]??40, w.hourly.relativehumidity_2m[ssIdx]??55, w.hourly.precipitation[ssIdx]??0, w.hourly.windspeed_10m[ssIdx]??15);
      }
      return {...spot, score, sunset: sunsetUTC ? formatLocalTime(sunsetUTC) : '--:--'};
    } catch { return {...spot, score:5, sunset:'--:--'}; }
  }));

  results.sort((a,b) => b.score-a.score);

  el.innerHTML = `
    <div class="world-map-header">
      <h2 style="font-family:'Playfair Display',serif;font-size:20px">ğŸ—ºï¸ ×™×¢×“×™ ×©×§×™×¢×•×ª ××•×‘×™×œ×™×</h2>
      <p>×“×™×¨×•×’ ×œ×¤×™ ×ª×—×–×™×ª ×¦×‘×¢×•× ×™×•×ª ×œ×”×™×•×</p>
    </div>` +
    results.map((spot,i) => {
      const q = getQualityInfo(spot.score);
      return `<div class="hotspot-card" style="animation-delay:${i*0.08}s">
        <div class="hotspot-rank">${i+1}</div>
        <div class="hotspot-info">
          <div class="hotspot-name">${spot.emoji} ${spot.name}</div>
          <div class="hotspot-desc">${spot.desc}</div>
          <div style="font-size:11px;color:var(--muted);margin-top:4px">×©×§×™×¢×” (×©×¢×•×Ÿ ××§×•××™): ${spot.sunset}</div>
        </div>
        <div class="hotspot-score">
          <div class="hotspot-score-num quality-${q.cls}">${spot.score}</div>
          <div class="hotspot-score-label">××ª×•×š 10</div>
          <div style="font-size:10px;margin-top:2px">${q.label}</div>
        </div>
      </div>`;
    }).join('');
}

// â”€â”€ Notifications â”€â”€
async function toggleNotifications() {
  if (!('Notification' in window)) { alert('×“×¤×“×¤×Ÿ ×–×” ××™× ×• ×ª×•××š ×‘×”×ª×¨××•×ª'); return; }
  if (!notifEnabled) {
    const perm = await Notification.requestPermission();
    if (perm !== 'granted') { alert('× × ×œ××¤×©×¨ ×”×ª×¨××•×ª ×‘×”×’×“×¨×•×ª ×”×“×¤×“×¤×Ÿ'); return; }
    notifEnabled = true;
    localStorage.setItem('shakey_notif','1');
    document.getElementById('notifBtn').textContent='×¤×¢×™×œ âœ“';
    document.getElementById('notifBtn').classList.remove('off');
    if (currentSunData && currentWeatherData) scheduleNotifications(currentSunData, currentWeatherData);
  } else {
    notifEnabled = false;
    localStorage.removeItem('shakey_notif');
    notifTimers.forEach(clearTimeout); notifTimers=[];
    document.getElementById('notifBtn').textContent='×”×¤×¢×œ';
    document.getElementById('notifBtn').classList.add('off');
  }
}

function scheduleNotifications(sunData, weatherData) {
  notifTimers.forEach(clearTimeout); notifTimers=[];
  const now = Date.now();
  sunData.forEach((day,i) => {
    if (!day) return;
    const dateStr = new Date(Date.now()+i*86400000).toISOString().split('T')[0];

    [
      {utc: day.sunrise, label:'×–×¨×™×—×”', isSunset:false},
      {utc: day.sunset,  label:'×©×§×™×¢×”', isSunset:true}
    ].forEach(({utc, label, isSunset}) => {
      if (!utc) return;
      const eventTime = new Date(utc).getTime();
      const notifTime = eventTime - 60*60*1000; // 1hr before
      if (notifTime <= now) return;

      const hour = new Date(utc).getHours();
      let score = 5;
      if (weatherData?.hourly) {
        const idx = getHourlyIndex(weatherData, dateStr, hour);
        score = calcColorScore(weatherData.hourly.cloudcover[idx]??40, weatherData.hourly.relativehumidity_2m[idx]??55, weatherData.hourly.precipitation[idx]??0, weatherData.hourly.windspeed_10m[idx]??15);
      }

      if (score >= 8) {
        const delay = notifTime - now;
        const t = setTimeout(() => {
          new Notification(`ğŸŒ… ×©×—×§×™ ××•×¨ â€” ${label} ××“×”×™××” ×‘×¢×•×“ ×©×¢×”!`, {
            body: `×¦×™×•×Ÿ ×¦×‘×¢×•× ×™×•×ª: ${score}/10 â€” ${getQualityInfo(score).label}\n×¦× ×œ×¦×¤×•×ª! ${formatLocalTime(utc)}`,
            icon: 'icon-192.png'
          });
        }, delay);
        notifTimers.push(t);
      }
    });
  });
}

// â”€â”€ Share â”€â”€
async function shareApp() {
  const APK_LINK = 'https://drive.google.com/file/d/1lGmM9w8B71dgePXFh79aXFIVaLEZL9X5/view?usp=sharing';
  const shareData = { title:'×©×—×§×™ ××•×¨', text:'ğŸŒ… ×ª×—×–×™×ª ×¦×‘×¢×•× ×™×•×ª ×©×§×™×¢×•×ª ×•×–×¨×™×—×•×ª!\n×”×•×¨×“:', url:APK_LINK };
  try {
    if (navigator.share) await navigator.share(shareData);
    else { await navigator.clipboard.writeText(APK_LINK); alert('×”×§×™×©×•×¨ ×”×•×¢×ª×§! ğŸŒ…'); }
  } catch {}
}

init();
</script>
</body>
</html>
